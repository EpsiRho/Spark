<Page
    x:Class="Spark.Pages.Home"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:Spark.Pages"
    xmlns:classes="using:Spark.Classes"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
    xmlns:muxc="using:Microsoft.UI.Xaml.Controls"
    mc:Ignorable="d"
    Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">
    <Page.Resources>
        <Style x:Key="GridViewItemContainerStyle1" TargetType="GridViewItem">
            <Setter Property="FontFamily" Value="{ThemeResource ContentControlThemeFontFamily}"/>
            <Setter Property="FontSize" Value="{ThemeResource ControlContentThemeFontSize}"/>
            <Setter Property="Background" Value="{ThemeResource GridViewItemBackground}"/>
            <Setter Property="Foreground" Value="{ThemeResource GridViewItemForeground}"/>
            <Setter Property="TabNavigation" Value="Local"/>
            <Setter Property="IsHoldingEnabled" Value="True"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Margin" Value="0,0,4,4"/>
            <Setter Property="MinWidth" Value="{ThemeResource GridViewItemMinWidth}"/>
            <Setter Property="MinHeight" Value="{ThemeResource GridViewItemMinHeight}"/>
            <Setter Property="AllowDrop" Value="False"/>
            <Setter Property="UseSystemFocusVisuals" 
                    Value="False"/>
            <Setter Property="FocusVisualMargin" Value="0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="GridViewItem">
                        <ListViewItemPresenter x:Name="Root" CheckMode="{ThemeResource GridViewItemCheckMode}" CheckBoxBrush="{ThemeResource GridViewItemCheckBoxBrush}" CheckBrush="{ThemeResource GridViewItemCheckBrush}" ContentMargin="{TemplateBinding Padding}" ContentTransitions="{TemplateBinding ContentTransitions}" DragOpacity="{ThemeResource ListViewItemDragThemeOpacity}" DragBackground="{ThemeResource GridViewItemDragBackground}" DisabledOpacity="{ThemeResource ListViewItemDisabledThemeOpacity}" DragForeground="{ThemeResource GridViewItemDragForeground}" FocusVisualMargin="{TemplateBinding FocusVisualMargin}" FocusBorderBrush="{ThemeResource GridViewItemFocusBorderBrush}" FocusSecondaryBorderBrush="{ThemeResource GridViewItemFocusSecondaryBorderBrush}" HorizontalContentAlignment="{TemplateBinding HorizontalContentAlignment}" Control.IsTemplateFocusTarget="True" PlaceholderBackground="{ThemeResource GridViewItemPlaceholderBackground}" PointerOverBackground="{ThemeResource GridViewItemBackgroundPointerOver}" PointerOverForeground="{ThemeResource GridViewItemForegroundPointerOver}" PressedBackground="{ThemeResource GridViewItemBackgroundPressed}" RevealBorderThickness="0" RevealBackground="Transparent" RevealBorderBrush="Transparent" ReorderHintOffset="{ThemeResource GridViewItemReorderHintThemeOffset}" SelectedForeground="{ThemeResource GridViewItemForegroundSelected}" SelectedPointerOverBackground="{ThemeResource GridViewItemBackgroundSelectedPointerOver}" SelectionCheckMarkVisualEnabled="{ThemeResource GridViewItemSelectionCheckMarkVisualEnabled}" SelectedBackground="{ThemeResource GridViewItemBackgroundSelected}" SelectedPressedBackground="{ThemeResource GridViewItemBackgroundSelectedPressed}" VerticalContentAlignment="{TemplateBinding VerticalContentAlignment}">
                            <VisualStateManager.VisualStateGroups>
                                <VisualStateGroup x:Name="CommonStates">
                                    <VisualState x:Name="Normal"/>
                                    <VisualState x:Name="Selected">
                                        <VisualState.Setters>
                                            <Setter Target="Root.CornerRadius" Value="10" />
                                            <Setter Target="Root.CornerRadius" Value="10" />
                                        </VisualState.Setters>
                                    </VisualState>
                                    <VisualState x:Name="PointerOver">
                                        <VisualState.Setters>
                                            <Setter Target="Root.(RevealBrush.State)" Value="PointerOver"/>
                                            <Setter Target="Root.CornerRadius" Value="10" />
                                        </VisualState.Setters>
                                    </VisualState>
                                    <VisualState x:Name="PointerOverSelected">
                                        <VisualState.Setters>
                                            <Setter Target="Root.CornerRadius" Value="10" />
                                            <Setter Target="Root.(RevealBrush.State)" Value="PointerOver"/>
                                        </VisualState.Setters>
                                    </VisualState>
                                    <VisualState x:Name="PointerOverPressed">
                                        <VisualState.Setters>
                                            <Setter Target="Root.CornerRadius" Value="10" />
                                            <Setter Target="Root.(RevealBrush.State)" Value="Pressed"/>
                                        </VisualState.Setters>
                                    </VisualState>
                                    <VisualState x:Name="Pressed">
                                        <VisualState.Setters>
                                            <Setter Target="Root.CornerRadius" Value="10" />
                                            <Setter Target="Root.(RevealBrush.State)" Value="Pressed"/>
                                        </VisualState.Setters>
                                    </VisualState>
                                    <VisualState x:Name="PressedSelected">
                                        <VisualState.Setters>
                                            <Setter Target="Root.CornerRadius" Value="10" />
                                            <Setter Target="Root.(RevealBrush.State)" Value="Pressed"/>
                                        </VisualState.Setters>
                                    </VisualState>
                                </VisualStateGroup>
                                <VisualStateGroup x:Name="DisabledStates">
                                    <VisualState x:Name="Enabled"/>
                                    <VisualState x:Name="Disabled">
                                        <VisualState.Setters>
                                            <Setter Target="Root.RevealBorderThickness" Value="0"/>
                                            <Setter Target="Root.CornerRadius" Value="10" />
                                        </VisualState.Setters>
                                    </VisualState>
                                </VisualStateGroup>
                            </VisualStateManager.VisualStateGroups>
                        </ListViewItemPresenter>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Page.Resources>

    <Grid>
        <!--
            Main Grid Layout:
            Separated into a few cards
            ┌─────────────────────────────────────────────────┐
            │  1               4                              │
            │                                                 │
            │                                                 │
            │  2               5                              │
            │                                                 │
            │                                                 │
            └─────────────────────────────────────────────────┘
            ┌──────────────────────────────────────┐┌─────────┐
            │                  3                   ││         │
            │                                      ││         │
            │                                      ││         │
            │                                      ││         │
            │                                      ││         │
            │                                      ││         │
            │                                      ││         │
            │                                      ││         │
            │                                      ││         │
            │                                      ││         │
            │                                      ││         │
            │                                      ││         │
            │                                      ││         │
            └──────────────────────────────────────┘└─────────┘
        
        
            Server Info to display:
            1 Status (Is it online?)
            2 World Size
            3 Server Name
            4 Current Player Count
            5 IP+Port
            
        -->
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="30*"/>
                <RowDefinition Height="80*"/>
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="80*"/>
                <ColumnDefinition Width="30*"/>
            </Grid.ColumnDefinitions>



            <!--
                Top Card: Server Status
            -->
            <Border Grid.ColumnSpan="2"
                    Background="#202020"
                    CornerRadius="10"
                    Margin="10,10,30,0">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    
                    
                    <!--
                        Sever Power Status
                    -->
                    <Border Background="#1a1a1a"
                            Grid.Column="0"
                            Grid.Row="0"
                            Margin="0,0,5,5"
                            CornerRadius="10">
                        <StackPanel HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    ToolTipService.ToolTip="Server's online status">
                            <FontIcon FontFamily="{ThemeResource SymbolThemeFontFamily}" 
                                      Glyph="&#xE7E8;" 
                                      FontSize="24"
                                      Tapped="PowerIcon_Tapped"
                                      x:Name="PowerIcon"
                                      Margin="0"
                                      FontWeight="Bold"/>
                            <TextBlock Text="No Server Selected"
                                       TextAlignment="Center"
                                       x:Name="ServerPowerState"
                                       FontSize="18"/>
                            <muxc:ProgressBar x:Name="StatusProgress"
                                              Visibility="Collapsed"
                                              IsIndeterminate="True"/>
                        </StackPanel>
                    </Border>



                    <!--
                        World Size
                    -->
                    <Border Background="#1a1a1a"
                            Grid.Column="0"
                            Grid.Row="1"
                            Margin="0,5,5,0"
                            CornerRadius="10">
                        <StackPanel HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    ToolTipService.ToolTip="Current world size">
                            <FontIcon FontFamily="{ThemeResource SymbolThemeFontFamily}" 
                                      Glyph="&#xE128;" 
                                      FontSize="24"
                                      x:Name="WorldIcon"
                                      FontWeight="Bold"/>
                            <TextBlock Text="No Server Selected"
                                       Margin="0,0,0,0"
                                       TextAlignment="Center"
                                       x:Name="ServerWorldSize"
                                       FontSize="18"/>
                            <muxc:ProgressBar x:Name="WorldProgress"
                                              Visibility="Collapsed"
                                              IsIndeterminate="True"/>
                        </StackPanel>
                    </Border>



                    <!--
                        IP and port
                    -->
                    <Border Background="#1a1a1a"
                            Grid.Column="1"
                            Grid.Row="0"
                            Margin="5,0,0,5"
                            CornerRadius="10">
                        <StackPanel HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    ToolTipService.ToolTip="The server's IP and Port">
                            <FontIcon FontFamily="{ThemeResource SymbolThemeFontFamily}" 
                                      Glyph="&#xE704;" 
                                      FontSize="24"
                                      x:Name="IPIcon"
                                      Margin="0"
                                      FontWeight="Bold"/>
                            <TextBlock Text="No Server Selected"
                                       TextAlignment="Center"
                                       x:Name="ServerIPPort"
                                       FontSize="18"/>
                            <muxc:ProgressBar x:Name="IPPortProgress"
                                              Visibility="Collapsed"
                                              IsIndeterminate="True"/>
                        </StackPanel>
                    </Border>


                    
                    <!--
                        Player Count
                    -->
                    <Border Background="#1a1a1a"
                            Grid.Column="1"
                            Grid.Row="1"
                            Margin="5,5,0,0"
                            CornerRadius="10">
                        <StackPanel HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    ToolTipService.ToolTip="# of players online">
                            <FontIcon FontFamily="{ThemeResource SymbolThemeFontFamily}" 
                                      Glyph="&#xE125;" 
                                      FontSize="24"
                                      x:Name="PlayerIcon"
                                      FontWeight="Bold"/>
                            <TextBlock Text="No Server Selected"
                                       Margin="0,0,0,0"
                                       TextAlignment="Center"
                                       x:Name="ServerPlayerCount"
                                       FontSize="18"/>
                            <muxc:ProgressBar x:Name="PlayerProgress"
                                              Visibility="Collapsed"
                                              IsIndeterminate="True"/>
                        </StackPanel>
                    </Border>



                </Grid>
            </Border>



            <!--
                Left Card: Server Picker / More Server Info after a server has been selected
            
                ┌──────────────┐
                │    Furden    │
                │Version: 1.18 │
                │Last Online:  │
                │C:/Users/Epsi/│
                │              │
                │              │
                └──────────────┘
            -->
            <Border Grid.Column="0"
                    Grid.Row="1"
                    Background="#1a1a1a"
                    CornerRadius="10"
                    Margin="10,10,5,10">
                <Grid>
                    <StackPanel HorizontalAlignment="Center">
                        <!--
                            Server selection title and add new button
                        -->
                        <StackPanel Orientation="Horizontal"
                                    HorizontalAlignment="Center">
                            <TextBlock Text="Select a Server"
                                       TextDecorations="Underline"
                                       HorizontalAlignment="Center"
                                       FontSize="24"
                                       Margin="50,10,0,0"/>
                            <Button Margin="10,10,0,0"
                                    x:Name="AddNewServerButton"
                                    Click="AddNewServerButton_Click">
                                <FontIcon FontFamily="{ThemeResource SymbolThemeFontFamily}" 
                                          Glyph="&#xE109;"
                                          Height="25"/>
                            </Button>
                        </StackPanel>
                        
                        
                        
                        <!--
                            Grid View of servers
                        -->
                        <GridView ItemContainerStyle="{StaticResource GridViewItemContainerStyle1}" x:Name="ServersGridView"
                                  SelectionMode="Single"
                                  SelectedIndex="0"
                                  HorizontalAlignment="Left"
                                  IsItemClickEnabled="True"
                                  ItemClick="ServersGridView_ItemClick"
                                  
                                  ItemsSource="{x:Bind serverViewModel.Servers}"
                                  Margin="10,10,10,10">
                            <GridView.ItemTemplate>
                                <DataTemplate x:DataType="classes:Server">
                                    <Grid Width="170"
                                          Height="130"
                                          Background="#262626"
                                          CornerRadius="10">
                                        <StackPanel VerticalAlignment="Center"
                                                    HorizontalAlignment="Center">
                                            <TextBlock Text="{x:Bind Name}"
                                                       FontSize="20"
                                                       HorizontalAlignment="Center"
                                                       TextTrimming="CharacterEllipsis"
                                                       Margin="10,10,10,0"/>
                                            <TextBlock Text="{x:Bind FolderVersion}"
                                                       FontSize="14"
                                                       TextTrimming="CharacterEllipsis"
                                                       HorizontalAlignment="Center"
                                                       Margin="10,0,10,0"/>
                                            <TextBlock Text="{x:Bind Date}"
                                                       FontSize="14"
                                                       HorizontalAlignment="Center"
                                                       TextTrimming="CharacterEllipsis"
                                                       Margin="10,0,10,0"/>
                                            <TextBlock Text="{x:Bind FolderPth}"
                                                       FontSize="14"
                                                       HorizontalAlignment="Center"
                                                       TextTrimming="CharacterEllipsis"
                                                       Margin="10,0,10,10"/>
                                        </StackPanel>
                                    </Grid>
                                </DataTemplate>
                            </GridView.ItemTemplate>
                        </GridView>
                        
                        
                        
                        
                    </StackPanel>
                </Grid>
            </Border>


            <!--
                Right Card: Server Quick Commands
            -->
            <Border Grid.Column="1"
                    Grid.Row="1"
                    Background="#1a1a1a"
                    CornerRadius="10"
                    Margin="5,10,30,10">
                <Grid>
                    <TextBox x:Name="DebugConsole"
                             AcceptsReturn="True"/>
                </Grid>
            </Border>
            

            
            <!--
                Content Dialog for adding a new server
            -->
            <ContentDialog Title="Add New Server"
                           x:Name="NewServerDialog"
                           PrimaryButtonText="Add"
                           PrimaryButtonClick="NewServerDialog_PrimaryButtonClick"
                           CloseButtonText="Cancel">
                <Grid>
                    <Pivot x:Name="AdditionPivot">
                        <PivotItem Header="Local Folder">
                            <StackPanel>
                                <Button x:Name="LocalFolderButton"
                                        Content="Select Server Folder"
                                        Click="LocalFolderButton_Click"
                                        Margin="0,10,0,0"/>
                                <TextBlock x:Name="LocalFolderText"
                                           FontSize="16"
                                           TextTrimming="CharacterEllipsis"/>
                                <TextBlock Text="Server Name"
                                           FontSize="18"
                                           Margin="0,10,0,0"/>
                                <TextBox x:Name="ServerNameEntry"
                                         Margin="0,0,0,0"/>
                                <TextBlock Text="Server Version"
                                           FontSize="18"
                                           Margin="0,10,0,0"/>
                                <TextBox x:Name="ServerVersionEntry"
                                         Margin="0,0,0,0"/>
                            </StackPanel>
                        </PivotItem>
                        <PivotItem Header="Download Server">
                            <ScrollViewer MinHeight="300">
                                <Grid>
                                    <StackPanel>
                                        <Button x:Name="DownloadFolderButton"
                                                Content="Select Download Location"
                                                VerticalAlignment="Top"
                                                Click="DownloadFolderButton_Click"
                                                Margin="0,10,0,0"/>
                                        <TextBlock x:Name="DownloadFolderText"
                                                   FontSize="16"
                                                   TextTrimming="CharacterEllipsis"/>
                                    </StackPanel>
                                    <muxc:TreeView AllowDrop="false"
                                                   CanDrag="false"
                                                   Visibility="Collapsed"
                                                   CanDragItems="False"
                                                   x:Name="JarsView"
                                                   Margin="0,65,0,0"
                                                   SelectionMode="Single"
                                                   ItemInvoked="JarsView_ItemInvoked"
                                                   ItemsSource="{x:Bind TreeViewSource}">
                                        <muxc:TreeView.ItemTemplate>
                                            <DataTemplate x:DataType="classes:CustomTreeViewItem">
                                                <muxc:TreeViewItem ItemsSource="{x:Bind Jars}"
                                                                   Content="{x:Bind Type}"/>
                                            </DataTemplate>
                                        </muxc:TreeView.ItemTemplate>
                                    </muxc:TreeView>
                                </Grid>
                            </ScrollViewer>
                        </PivotItem>
                    </Pivot>
                </Grid>
            </ContentDialog>



            <!--
                Permissions Dialog
            -->
            <ContentDialog Title="Permissions Error"
                           x:Name="PermsDialog"
                           PrimaryButtonText="Take me to my settings!"
                           PrimaryButtonClick="PermsDialog_PrimaryButtonClick"
                           SecondaryButtonClick="PermsDialog_SecondaryButtonClick"
                           SecondaryButtonText="Sorry, maybe later!">
                <Grid>
                    <TextBlock FontSize="20"
                               Text="Spark needs to access your filesystem! Clicking OK will take you to your settings so you can give this app permission. Spark will not work correctly without it."/>
                </Grid>
            </ContentDialog>



        </Grid>
    </Grid>
</Page>
